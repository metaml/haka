Code follows this paper: https://www.cs.ox.ac.uk/ralf.hinze/publications/Bird.pdf
